jQuery(document).ready(function(){jQuery("input#aw-whats-new-submit").click(function(){tinyMCE.triggerSave();jQuery("#whats-new_ifr").contents().find("#tinymce").html("")});jQuery("input#send_reply_button").click(function(){tinyMCE.triggerSave();jQuery("#whats-new_ifr").contents().find("#tinymce").html("")})});var jq=jQuery,bp_ajax_request=null,newest_activities="",activity_last_recorded=0;
jq(document).ready(function(){"-1"===window.location.search.indexOf("new")&&jq("div.forums").length?jq("#new-topic-post").hide():jq("#new-topic-post").show();bp_init_activity();var c=jq("#whats-new");bp_init_objects(["members","groups","blogs","forums","group_members"]);if(c.length&&bp_get_querystring("r")){var d=c.val();jq.scrollTo(c,500,{offset:-125,easing:"swing"});c.val("").focus().val(d)}c.focus(function(){jq("#aw-whats-new-submit").prop("disabled",!1);var a=jq("form#whats-new-form"),b=jq("#activity-all");
a.hasClass("submitted")&&a.removeClass("submitted");b.length&&(b.hasClass("selected")?"-1"!==jq("#activity-filter-select select").val()&&(jq("#activity-filter-select select").val("-1"),jq("#activity-filter-select select").trigger("change")):(jq("#activity-filter-select select").val("-1"),b.children("a").trigger("click")))});jq("#aw-whats-new-submit").on("click",function(){var a=0,b=jq(this),e=b.closest("form#whats-new-form");e.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,
"input"))&&jq(this).prop("disabled",!0)});jq("div.error").remove();b.addClass("loading");b.prop("disabled",!0);e.addClass("submitted");object="";item_id=jq("#whats-new-post-in").val();content=jq("#whats-new").val();activity_row=firstrow=jq("#buddypress ul.activity-list li").first();timestamp=null;firstrow.length&&(activity_row.hasClass("load-newest")&&(activity_row=firstrow.next()),timestamp=activity_row.prop("class").match(/date-recorded-([0-9]+)/));timestamp&&(a=timestamp[1]);0<item_id&&(object=
jq("#whats-new-post-object").val());jq.post(ajaxurl,{action:"post_update",cookie:bp_get_cookies(),_wpnonce_post_update:jq("#_wpnonce_post_update").val(),content:content,object:object,item_id:item_id,since:a,_bp_as_nonce:jq("#_bp_as_nonce").val()||""},function(b){e.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!1)});if("-1"===b[0]+b[1])e.prepend(b.substr(2,b.length)),jq("#"+e.attr("id")+" div.error").hide().fadeIn(200);else{0===jq("ul.activity-list").length&&
(jq("div.error").slideUp(100).remove(),jq("#message").slideUp(100).remove(),jq("div.activity").append('<ul id="activity-stream" class="activity-list item-list">'));firstrow.hasClass("load-newest")&&firstrow.remove();jq("#activity-stream").prepend(b);a||jq("#activity-stream li:first").addClass("new-update just-posted");if(0!==jq("#latest-update").length){b=jq("#activity-stream li.new-update .activity-content .activity-inner p").html();var n=jq("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),
c="";""!==jq("#activity-stream li.new-update .activity-content .activity-inner p").text()&&(c=b+" ");c+='<a href="'+n+'" rel="nofollow">'+BP_DTheme.view+"</a>";jq("#latest-update").slideUp(300,function(){jq("#latest-update").html(c);jq("#latest-update").slideDown(300)})}jq("li.new-update").hide().slideDown(300);jq("li.new-update").removeClass("new-update");jq("#whats-new").val("");newest_activities="";activity_last_recorded=0}jq("#whats-new-options").animate({height:"0px"});jq("#whats-new-form textarea").animate({height:"20px"});
jq("#aw-whats-new-submit").prop("disabled",!0).removeClass("loading");bp_legacy_theme_hide_comments()});return!1});jq("div.activity-type-tabs").on("click",function(a){var b=jq(a.target).parent(),e;if("STRONG"===a.target.nodeName||"SPAN"===a.target.nodeName)b=b.parent();else if("A"!==a.target.nodeName)return!1;jq.cookie("bp-activity-oldestpage",1,{path:"/"});a=b.attr("id").substr(9,b.attr("id").length);e=jq("#activity-filter-select select").val();"mentions"===a&&jq("#"+b.attr("id")+" a strong").remove();
bp_activity_request(a,e);return!1});jq("#activity-filter-select select").change(function(){var a=jq("div.activity-type-tabs li.selected"),b=jq(this).val(),a=a.length?a.attr("id").substr(9,a.attr("id").length):null;bp_activity_request(a,b);return!1});jq("div.activity").on("click",function(a){var b=jq(a.target),e,g,c,d,f,l;if(b.hasClass("fav")||b.hasClass("unfav"))return e=b.hasClass("fav")?"fav":"unfav",a=b.closest(".activity-item"),a=a.attr("id").substr(9,a.attr("id").length),b.addClass("loading"),
jq.post(ajaxurl,{action:"activity_mark_"+e,cookie:bp_get_cookies(),id:a},function(a){b.removeClass("loading");b.fadeOut(200,function(){jq(this).html(a);jq(this).attr("title","fav"===e?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav);jq(this).fadeIn(200)});"fav"===e?(jq(".item-list-tabs #activity-favs-personal-li").length||(jq(".item-list-tabs #activity-favorites").length||jq(".item-list-tabs ul #activity-mentions").before('<li id="activity-favorites"><a href="#">'+BP_DTheme.my_favs+" <span>0</span></a></li>"),
jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())+1)),b.removeClass("fav"),b.addClass("unfav")):(b.removeClass("unfav"),b.addClass("fav"),jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())-1),Number(jq(".item-list-tabs ul #activity-favorites span").html())||(jq(".item-list-tabs ul #activity-favorites").hasClass("selected")&&bp_activity_request(null,null),jq(".item-list-tabs ul #activity-favorites").remove()));
"activity-favorites"===jq(".item-list-tabs li.selected").attr("id")&&b.closest(".activity-item").slideUp(100)}),!1;if(b.hasClass("delete-activity"))return g=b.parents("div.activity ul li"),a=g.attr("id").substr(9,g.attr("id").length),c=b.attr("href"),c=c.split("_wpnonce="),d=g.prop("class").match(/date-recorded-([0-9]+)/),c=c[1],b.addClass("loading"),jq.post(ajaxurl,{action:"delete_activity",cookie:bp_get_cookies(),id:a,_wpnonce:c},function(a){"-1"===a[0]+a[1]?(g.prepend(a.substr(2,a.length)),g.children("#message").hide().fadeIn(300)):
(g.slideUp(300),d&&activity_last_recorded===d[1]&&(newest_activities="",activity_last_recorded=0))}),!1;if(b.hasClass("spam-activity"))return g=b.parents("div.activity ul li"),d=g.prop("class").match(/date-recorded-([0-9]+)/),b.addClass("loading"),jq.post(ajaxurl,{action:"bp_spam_activity",cookie:encodeURIComponent(document.cookie),id:g.attr("id").substr(9,g.attr("id").length),_wpnonce:b.attr("href").split("_wpnonce=")[1]},function(a){"-1"===a[0]+a[1]?(g.prepend(a.substr(2,a.length)),g.children("#message").hide().fadeIn(300)):
(g.slideUp(300),d&&activity_last_recorded===d[1]&&(newest_activities="",activity_last_recorded=0))}),!1;if(b.parent().hasClass("load-more")){bp_ajax_request&&bp_ajax_request.abort();jq("#buddypress li.load-more").addClass("loading");null===jq.cookie("bp-activity-oldestpage")&&jq.cookie("bp-activity-oldestpage",1,{path:"/"});f=1*jq.cookie("bp-activity-oldestpage")+1;l=[];jq(".activity-list li.just-posted").each(function(){l.push(jq(this).attr("id").replace("activity-",""))});load_more_args={action:"activity_get_older_updates",
cookie:bp_get_cookies(),page:f,exclude_just_posted:l.join(",")};if(load_more_search=bp_get_querystring("s"))load_more_args.search_terms=load_more_search;bp_ajax_request=jq.post(ajaxurl,load_more_args,function(a){jq("#buddypress li.load-more").removeClass("loading");jq.cookie("bp-activity-oldestpage",f,{path:"/"});jq("#buddypress ul.activity-list").append(a.contents);b.parent().hide();jq("div.activity-comments").addClass("clearboth").find("form").css("display","none")},"json");return!1}b.parent().hasClass("load-newest")&&
(a.preventDefault(),b.parent().hide(),activity_html=jq.parseHTML(newest_activities),jq.each(activity_html,function(a,b){"LI"===b.nodeName&&jq(b).hasClass("just-posted")&&jq("#"+jq(b).attr("id")).length&&jq("#"+jq(b).attr("id")).remove()}),jq("#buddypress ul.activity-list").prepend(newest_activities),newest_activities="")});jq("div.activity").on("click",".activity-read-more a",function(a){a=jq(a.target);var b=a.parent().attr("id").split("-"),e=b[3],b=b[0],g;g=jq("#"+b+"-"+e+" ."+("acomment"===b?"acomment-content":
"activity-inner")+":first");jq(a).addClass("loading");jq.post(ajaxurl,{action:"get_single_activity_content",activity_id:e},function(a){jq(g).slideUp(300).html(a).slideDown(300)});return!1});jq("form.ac-form").hide();jq(".activity-comments").length&&bp_legacy_theme_hide_comments();jq("div.activity").on("click",function(a){var b=jq(a.target),e,g,c,d,f,l,h;if(b.hasClass("acomment-reply")||b.parent().hasClass("acomment-reply"))return b.parent().hasClass("acomment-reply")&&(b=b.parent()),a=b.attr("id"),
a=a.split("-"),e=a[2],g=b.attr("href").substr(10,b.attr("href").length),c=jq("#ac-form-"+e),c.css("display","none"),c.removeClass("root"),jq(".ac-form").hide(),c.children("div").each(function(){jq(this).hasClass("error")&&jq(this).hide()}),"comment"!==a[1]?jq("#acomment-"+g).append(c):jq("#activity-"+e+" .activity-comments").append(c),c.parent().hasClass("activity-comments")&&c.addClass("root"),c.slideDown(200),jq.scrollTo(c,500,{offset:-100,easing:"swing"}),jq("#ac-form-"+a[2]+" textarea").focus(),
!1;if("ac_form_submit"===b.attr("name"))return c=b.parents("form"),a=c.parent(),d=c.attr("id").split("-"),a.hasClass("activity-comments")?a=d[2]:(a=a.attr("id").split("-"),a=a[1]),content=jq("#"+c.attr("id")+" textarea"),jq("#"+c.attr("id")+" div.error").hide(),b.addClass("loading").prop("disabled",!0),content.addClass("loading").prop("disabled",!0),e={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:jq("#_wpnonce_new_activity_comment").val(),comment_id:a,form_id:d[2],
content:content.val()},(g=jq("#_bp_as_nonce_"+a).val())&&(e["_bp_as_nonce_"+a]=g),jq.post(ajaxurl,e,function(a){b.removeClass("loading");content.removeClass("loading");if("-1"===a[0]+a[1])c.append(jq(a.substr(2,a.length)).hide().fadeIn(200));else{var e=c.parent();c.fadeOut(200,function(){0===e.children("ul").length&&(e.hasClass("activity-comments")?e.prepend("<ul></ul>"):e.append("<ul></ul>"));var b=jq.trim(a);e.children("ul").append(jq(b).hide().fadeIn(200));c.children("textarea").val("");e.parent().addClass("has-comments")});
jq("#"+c.attr("id")+" textarea").val("");jq("#activity-"+d[2]+" a.acomment-reply span").html(Number(jq("#activity-"+d[2]+" a.acomment-reply span").html())+1);e.find("ul").addClass("list-unstyled");if(f=e.find(".show-all").find("a"))l=jq("li#activity-"+d[2]+" a.acomment-reply span").html(),f.html(BP_DTheme.show_x_comments.replace("%d",l))}jq(b).prop("disabled",!1);jq(content).prop("disabled",!1)}),!1;if(b.hasClass("acomment-delete"))return a=b.attr("href"),h=b.parent().parent(),c=h.parents("div.activity-comments").children("form"),
e=a.split("_wpnonce="),e=e[1],a=a.split("cid="),a=a[1].split("&"),a=a[0],b.addClass("loading"),jq(".activity-comments ul .error").remove(),h.parents(".activity-comments").append(c),jq.post(ajaxurl,{action:"delete_activity_comment",cookie:bp_get_cookies(),_wpnonce:e,id:a},function(a){if("-1"===a[0]+a[1])h.prepend(jq(a.substr(2,a.length)).hide().fadeIn(200));else{a=jq("#"+h.attr("id")+" ul").children("li");var b=0,e;jq(a).each(function(){jq(this).is(":hidden")||b++});h.fadeOut(200,function(){h.remove()});
e=jq("#"+h.parents("#activity-stream > li").attr("id")+" a.acomment-reply span");a=e.html()-(1+b);e.html(a);(e=h.siblings(".show-all").find("a"))&&e.html(BP_DTheme.show_x_comments.replace("%d",a));0===a&&jq(h.parents("#activity-stream > li")).removeClass("has-comments")}}),!1;if(b.hasClass("spam-activity-comment"))return a=b.attr("href"),h=b.parent().parent(),b.addClass("loading"),jq(".activity-comments ul div.error").remove(),h.parents(".activity-comments").append(h.parents(".activity-comments").children("form")),
jq.post(ajaxurl,{action:"bp_spam_activity_comment",cookie:encodeURIComponent(document.cookie),_wpnonce:a.split("_wpnonce=")[1],id:a.split("cid=")[1].split("&")[0]},function(a){if("-1"===a[0]+a[1])h.prepend(jq(a.substr(2,a.length)).hide().fadeIn(200));else{a=jq("#"+h.attr("id")+" ul").children("li");var b=0;jq(a).each(function(){jq(this).is(":hidden")||b++});h.fadeOut(200);a=h.parents("#activity-stream > li");jq("#"+a.attr("id")+" a.acomment-reply span").html(jq("#"+a.attr("id")+" a.acomment-reply span").html()-
(1+b))}}),!1;if(b.parent().hasClass("show-all"))return b.parent().addClass("loading"),setTimeout(function(){b.parent().parent().children("li").fadeIn(200,function(){b.parent().remove()})},600),!1;if(b.hasClass("ac-reply-cancel"))return jq(b).closest(".ac-form").slideUp(200),!1});jq(document).keydown(function(a){a=a||window.event;a.target?element=a.target:a.srcElement&&(element=a.srcElement);3===element.nodeType&&(element=element.parentNode);!0!==a.ctrlKey&&!0!==a.altKey&&!0!==a.metaKey&&27===(a.keyCode?
a.keyCode:a.which)&&"TEXTAREA"===element.tagName&&jq(element).hasClass("ac-input")&&jq(element).parent().parent().parent().slideUp(200)});jq(".dir-search, .groups-members-search").on("click",function(a){if(!jq(this).hasClass("no-ajax")){var b=jq(a.target),e,c;if("submit"===b.attr("type"))return e=jq(".item-list-tabs li.selected").attr("id").split("-"),e=e[0],c=null,"groups-members-search"===a.currentTarget.className&&(e="group_members",c="groups/single/members"),bp_filter_request(e,jq.cookie("bp-"+
e+"-filter"),jq.cookie("bp-"+e+"-scope"),"div."+e,b.parent().children("label").children("input").val(),1,jq.cookie("bp-"+e+"-extras"),null,c),!1}});jq("div.item-list-tabs").on("click",function(a){if(!jq(this).hasClass("no-ajax")&&!jq(a.target).hasClass("no-ajax")){a=jq("SPAN"===a.target.nodeName?a.target.parentNode:a.target).parent();var b,e,c;if("LI"===a[0].nodeName&&!a.hasClass("last")){b=a.attr("id").split("-");a=b[0];if("activity"===a)return!1;b=b[1];e=jq("#"+a+"-order-select select").val();c=
jq("#"+a+"_search").val();bp_filter_request(a,e,b,"div."+a,c,1,jq.cookie("bp-"+a+"-extras"));return!1}}});jq("li.filter select").change(function(){var a,b,e,c,d,f;a=(jq(".item-list-tabs li.selected").length?jq(".item-list-tabs li.selected"):jq(this)).attr("id").split("-");b=a[0];a=a[1];e=jq(this).val();c=!1;d=null;jq(".dir-search input").length&&(c=jq(".dir-search input").val());f=jq(".groups-members-search input");f.length&&(c=f.val(),b="members",a="groups");"members"===b&&"groups"===a&&(b="group_members",
d="groups/single/members");"friends"===b&&(b="members");bp_filter_request(b,e,a,"div."+b,c,1,jq.cookie("bp-"+b+"-extras"),null,d);return!1});jq("#buddypress").on("click",function(a){var b=jq(a.target),c,g,d,f,m;if(b.hasClass("button"))return!0;if(b.parent().parent().hasClass("pagination")&&!b.parent().parent().hasClass("no-ajax")){if(b.hasClass("dots")||b.hasClass("current"))return!1;a=jq(".item-list-tabs li.selected").length?jq(".item-list-tabs li.selected"):jq("li.filter select");c=a.attr("id").split("-");
a=c[0];g=!1;d=jq(b).closest(".pagination-links").attr("id");f=null;b=b.attr("href").split("=");b=b[1];jq("div.dir-search input").length&&(g=jq(".dir-search input").val(),!g&&bp_get_querystring("s")&&(g=jq(".dir-search input").prop("placeholder")));m=jq(".groups-members-search input");m.length&&(g=m.val(),a="members");"members"===a&&"groups"===c[1]&&(a="group_members",f="groups/single/members");"admin"===a&&jq("body").hasClass("membership-requests")&&(a="requests");c=-1!==d.indexOf("pag-bottom")?"pag-bottom":
null;bp_filter_request(a,jq.cookie("bp-"+a+"-filter"),jq.cookie("bp-"+a+"-scope"),"div."+a,g,b,jq.cookie("bp-"+a+"-extras"),c,f);return!1}});jq("a.show-hide-new").on("click",function(){if(!jq("#new-topic-post").length)return!1;jq("#new-topic-post").is(":visible")?jq("#new-topic-post").slideUp(200):jq("#new-topic-post").slideDown(200,function(){jq("#topic_title").focus()});return!1});jq("#submit_topic_cancel").on("click",function(){if(!jq("#new-topic-post").length)return!1;jq("#new-topic-post").slideUp(200);
return!1});jq("#forum-directory-tags a").on("click",function(){bp_filter_request("forums","tags",jq.cookie("bp-forums-scope"),"div.forums",jq(this).html().replace(/&nbsp;/g,"-"),1,jq.cookie("bp-forums-extras"));return!1});jq("#send-invite-form").on("click","#invite-list input",function(){var a=jq("#send-invite-form > .invite").length,b,c;jq(".ajax-loader").toggle();a&&jq(this).parents("ul").find("input").prop("disabled",!0);b=jq(this).val();c=!0===jq(this).prop("checked")?"invite":"uninvite";a||jq(".item-list-tabs li.selected").addClass("loading");
jq.post(ajaxurl,{action:"groups_invite_user",friend_action:c,cookie:bp_get_cookies(),_wpnonce:jq("#_wpnonce_invite_uninvite_user").val(),friend_id:b,group_id:jq("#group_id").val()},function(d){jq("#message")&&jq("#message").hide();a?bp_filter_request("invite","bp-invite-filter","bp-invite-scope","div.invite",!1,1,"","",""):(jq(".ajax-loader").toggle(),"invite"===c?jq("#friend-list").append(d):"uninvite"===c&&jq("#friend-list li#uid-"+b).remove(),jq(".item-list-tabs li.selected").removeClass("loading"))})});
jq("#send-invite-form").on("click","a.remove",function(){var a=jq("#send-invite-form > .invite").length,b=jq(this).attr("id");jq(".ajax-loader").toggle();b=b.split("-");b=b[1];jq.post(ajaxurl,{action:"groups_invite_user",friend_action:"uninvite",cookie:bp_get_cookies(),_wpnonce:jq("#_wpnonce_invite_uninvite_user").val(),friend_id:b,group_id:jq("#group_id").val()},function(c){a?bp_filter_request("invite","bp-invite-filter","bp-invite-scope","div.invite",!1,1,"","",""):(jq(".ajax-loader").toggle(),
jq("#friend-list #uid-"+b).remove(),jq("#invite-list #f-"+b).prop("checked",!1))});return!1});jq(".visibility-toggle-link").on("click",function(a){a.preventDefault();jq(this).parent().hide().addClass("field-visibility-settings-hide").siblings(".field-visibility-settings").show().addClass("field-visibility-settings-open")});jq(".field-visibility-settings-close").on("click",function(a){a.preventDefault();a=jq(this).parent();var b=a.find("input:checked").parent().text();a.hide().removeClass("field-visibility-settings-open").siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(b).end().show().removeClass("field-visibility-settings-hide")});
jq("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var a=!0;jq("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){a=!1});window.onbeforeunload=function(b){if(a)return BP_DTheme.unsaved_changes}});jq("#friend-list a.accept, #friend-list a.reject").on("click",function(){var a=jq(this),b=jq(this).parents("#friend-list li"),c=
jq(this).parents("li div.action"),d=b.attr("id").substr(11,b.attr("id").length),f=a.attr("href").split("_wpnonce=")[1],k;if(jq(this).hasClass("accepted")||jq(this).hasClass("rejected"))return!1;jq(this).hasClass("accept")?(k="accept_friendship",c.children("a.reject").css("visibility","hidden")):(k="reject_friendship",c.children("a.accept").css("visibility","hidden"));a.addClass("loading");jq.post(ajaxurl,{action:k,cookie:bp_get_cookies(),id:d,_wpnonce:f},function(d){a.removeClass("loading");"-1"===
d[0]+d[1]?(b.prepend(d.substr(2,d.length)),b.children("#message").hide().fadeIn(200)):a.fadeOut(100,function(){jq(this).hasClass("accept")?(c.children("a.reject").hide(),jq(this).html(BP_DTheme.accepted).contents().unwrap()):(c.children("a.accept").hide(),jq(this).html(BP_DTheme.rejected).contents().unwrap())})});return!1});jq("#members-dir-list, #members-group-list, #item-header").on("click",".friendship-button a",function(){jq(this).parent().addClass("loading");var a=jq(this).attr("id"),b=jq(this).attr("href"),
c=jq(this),a=a.split("-"),a=a[1],b=b.split("?_wpnonce="),b=b[1].split("&"),b=b[0];jq.post(ajaxurl,{action:"addremove_friend",cookie:bp_get_cookies(),fid:a,_wpnonce:b},function(a){var b=c.attr("rel");parentdiv=c.parent();"add"===b?jq(parentdiv).fadeOut(200,function(){parentdiv.removeClass("add_friend");parentdiv.removeClass("loading");parentdiv.addClass("pending_friend");parentdiv.fadeIn(200).html(a)}):"remove"===b&&jq(parentdiv).fadeOut(200,function(){parentdiv.removeClass("remove_friend");parentdiv.removeClass("loading");
parentdiv.addClass("add");parentdiv.fadeIn(200).html(a)})});return!1});jq("#buddypress").on("click",".group-button .leave-group",function(){if(!1===confirm(BP_DTheme.leave_group_confirm))return!1});jq("#groups-dir-list").on("click",".group-button a",function(){var a=jq(this).parent().attr("id"),b=jq(this).attr("href"),c=jq(this),a=a.split("-"),a=a[1],b=b.split("?_wpnonce="),b=b[1].split("&"),b=b[0];if(c.hasClass("leave-group")&&!1===confirm(BP_DTheme.leave_group_confirm))return!1;jq.post(ajaxurl,
{action:"joinleave_group",cookie:bp_get_cookies(),gid:a,_wpnonce:b},function(a){var b=c.parent();jq("body.directory").length?jq(b).fadeOut(200,function(){b.fadeIn(200).html(a);var d=jq("#groups-personal span"),f=1;c.hasClass("leave-group")?(b.hasClass("hidden")&&b.closest("li").slideUp(200),f=0):c.hasClass("request-membership")&&(f=!1);d.length&&!1!==f&&(f?d.text((d.text()>>0)+1):d.text((d.text()>>0)-1))}):location.href=location.href});return!1});jq("#buddypress").on("click",".pending",function(){return!1});
jq("body").hasClass("register")&&(c=jq("#signup_with_blog"),c.prop("checked")||jq("#blog-details").toggle(),c.change(function(){jq("#blog-details").toggle()}));jq(".message-search").on("click",function(a){if(!jq(this).hasClass("no-ajax")&&(a=jq(a.target),"submit"===a.attr("type")||"button"===a.attr("type")))return bp_filter_request("messages",jq.cookie("bp-messages-filter"),jq.cookie("bp-messages-scope"),"div.messages",jq("#messages_search").val(),1,jq.cookie("bp-messages-extras")),!1});jq("#send_reply_button").click(function(){var a=
jq("#messages_order").val()||"ASC",b=jq("#message-recipients").offset(),c=jq("#send_reply_button");jq(c).addClass("loading");jq.post(ajaxurl,{action:"messages_send_reply",cookie:bp_get_cookies(),_wpnonce:jq("#send_message_nonce").val(),content:jq("#message_content").val(),send_to:jq("#send_to").val(),subject:jq("#subject").val(),thread_id:jq("#thread_id").val()},function(d){"-1"===d[0]+d[1]?jq("#send-reply").prepend(d.substr(2,d.length)):(jq("#send-reply #message").remove(),jq("#message_content").val(""),
"ASC"===a?jq("#send-reply").before(d):(jq("#message-recipients").after(d),jq(window).scrollTop(b.top)),jq(".new-message").hide().slideDown(200,function(){jq(".new-message").removeClass("new-message")}));jq(c).removeClass("loading")});return!1});jq("#mark_as_read, #mark_as_unread").click(function(){var a="",b=jq('#message-threads tr td input[type="checkbox"]'),c,d,f,k,m,l;"mark_as_unread"===jq(this).attr("id")?(c="read",d="unread",f=1,k="inline",m="messages_markunread"):(c="unread",d="read",f=0,k=
"none",m="messages_markread");b.each(function(h){jq(this).is(":checked")&&jq("#m-"+jq(this).attr("value")).hasClass(c)&&(a+=jq(this).attr("value"),jq("#m-"+jq(this).attr("value")).removeClass(c),jq("#m-"+jq(this).attr("value")).addClass(d),jq("#m-"+jq(this).attr("value")+" td span.unread-count").html(),jq("#m-"+jq(this).attr("value")+" td span.unread-count").html(f),jq("#m-"+jq(this).attr("value")+" td span.unread-count").css("display",k),l=jq("tr.unread").length,jq("#user-messages span").html(l),
h!==b.length-1&&(a+=","))});jq.post(ajaxurl,{action:m,thread_ids:a});return!1});jq("body.messages #item-body div.messages").on("change","#message-type-select",function(){var a=this.value,b=jq('td input[type="checkbox"]'),c="checked";b.each(function(a){b[a].checked=""});switch(a){case "unread":b=jq('tr.unread td input[type="checkbox"]');break;case "read":b=jq('tr.read td input[type="checkbox"]');break;case "":c=""}b.each(function(a){b[a].checked=c})});jq("body.messages #item-body div.messages").on("click",
".messages-options-nav a",function(){if(-1!==jq.inArray(this.id,["delete_sentbox_messages","delete_inbox_messages"])){checkboxes_tosend="";checkboxes=jq('#message-threads tr td input[type="checkbox"]');jq("#message").remove();jq(this).addClass("loading");jq(checkboxes).each(function(a){jq(this).is(":checked")&&(checkboxes_tosend+=jq(this).attr("value")+",")});if(""===checkboxes_tosend)return jq(this).removeClass("loading"),!1;jq.post(ajaxurl,{action:"messages_delete",thread_ids:checkboxes_tosend},
function(a){"-1"===a[0]+a[1]?jq("#message-threads").prepend(a.substr(2,a.length)):(jq("#message-threads").before('<div id="message" class="updated"><p>'+a+"</p></div>"),jq(checkboxes).each(function(a){jq(this).is(":checked")&&(jq(this).attr("checked",!1),jq(this).parent().parent().fadeOut(150))}));jq("#message").hide().slideDown(150);jq("#delete_inbox_messages, #delete_sentbox_messages").removeClass("loading")});return!1}});jq("#select-all-messages").click(function(a){this.checked?jq(".message-check").each(function(){this.checked=
!0}):jq(".message-check").each(function(){this.checked=!1})});jq("#messages-bulk-manage").attr("disabled","disabled");jq("#messages-select").on("change",function(){jq("#messages-bulk-manage").attr("disabled",0>=jq(this).val().length)});jq("#select-all-notifications").click(function(a){this.checked?jq(".notification-check").each(function(){this.checked=!0}):jq(".notification-check").each(function(){this.checked=!1})});jq("#notification-bulk-manage").attr("disabled","disabled");jq("#notification-select").on("change",
function(){jq("#notification-bulk-manage").attr("disabled",0>=jq(this).val().length)});jq("#close-notice").on("click",function(){jq(this).addClass("loading");jq("#sidebar div.error").remove();jq.post(ajaxurl,{action:"messages_close_notice",notice_id:jq(".notice").attr("rel").substr(2,jq(".notice").attr("rel").length)},function(a){jq("#close-notice").removeClass("loading");"-1"===a[0]+a[1]?(jq(".notice").prepend(a.substr(2,a.length)),jq("#sidebar div.error").hide().fadeIn(200)):jq(".notice").slideUp(100)});
return!1});jq("#wp-admin-bar ul.main-nav li, #nav li").mouseover(function(){jq(this).addClass("sfhover")});jq("#wp-admin-bar ul.main-nav li, #nav li").mouseout(function(){jq(this).removeClass("sfhover")});jq("#wp-admin-bar-logout, a.logout").on("click",function(){jq.removeCookie("bp-activity-scope",{path:"/"});jq.removeCookie("bp-activity-filter",{path:"/"});jq.removeCookie("bp-activity-oldestpage",{path:"/"});var a=["members","groups","blogs","forums"];jq(a).each(function(b){jq.removeCookie("bp-"+
a[b]+"-scope",null,{path:"/"});jq.removeCookie("bp-"+a[b]+"-filter",null,{path:"/"});jq.removeCookie("bp-"+a[b]+"-extras",null,{path:"/"})})});jq("body").hasClass("no-js")&&jq("body").attr("class",jq("body").attr("class").replace(/no-js/,"js"));"undefined"!==typeof wp&&"undefined"!==typeof wp.heartbeat&&"undefined"!==typeof BP_DTheme.pulse&&(wp.heartbeat.interval(Number(BP_DTheme.pulse)),jq.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send.buddypress")}}));var f=0;jq(document).on("heartbeat-send.buddypress",
function(a,b){f=0;jq("#buddypress ul.activity-list li").first().prop("id")&&(timestamp=jq("#buddypress ul.activity-list li").first().prop("class").match(/date-recorded-([0-9]+)/))&&(f=timestamp[1]);if(0===activity_last_recorded||Number(f)>activity_last_recorded)activity_last_recorded=Number(f);b.bp_activity_last_recorded=activity_last_recorded;if(last_recorded_search=bp_get_querystring("s"))b.bp_activity_last_recorded_search_terms=last_recorded_search});jq(document).on("heartbeat-tick",function(a,
b){b.bp_activity_newest_activities&&(newest_activities=b.bp_activity_newest_activities.activities+newest_activities,activity_last_recorded=Number(b.bp_activity_newest_activities.last_recorded),jq("#buddypress ul.activity-list li").first().hasClass("load-newest")||jq("#buddypress ul.activity-list").prepend('<li class="load-newest"><a href="#newest">'+BP_DTheme.newest+"</a></li>"))})});
function bp_init_activity(){jq.cookie("bp-activity-oldestpage",1,{path:"/"});null!=jq.cookie("bp-activity-filter")&&jq("#activity-filter-select").length&&jq('#activity-filter-select select option[value="'+jq.cookie("bp-activity-filter")+'"]').prop("selected",!0);null!=jq.cookie("bp-activity-scope")&&jq(".activity-type-tabs").length&&(jq(".activity-type-tabs li").each(function(){jq(this).removeClass("selected active")}),jq("#activity-"+jq.cookie("bp-activity-scope")+", .item-list-tabs li.current").addClass("selected"))}
function bp_init_objects(c){jq(c).each(function(d){null!=jq.cookie("bp-"+c[d]+"-filter")&&jq("#"+c[d]+"-order-select select").length&&jq("#"+c[d]+'-order-select select option[value="'+jq.cookie("bp-"+c[d]+"-filter")+'"]').prop("selected",!0);null!=jq.cookie("bp-"+c[d]+"-scope")&&jq("div."+c[d]).length&&(jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected active")}),jq("#"+c[d]+"-"+jq.cookie("bp-"+c[d]+"-scope")+", #object-nav li.current").addClass("selected"))})}
function bp_filter_request(c,d,f,a,b,e,g,n,k){if("activity"===c)return!1;null===f&&(f="all");jq.cookie("bp-"+c+"-scope",f,{path:"/"});jq.cookie("bp-"+c+"-filter",d,{path:"/"});jq.cookie("bp-"+c+"-extras",g,{path:"/"});jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected active")});jq("#"+c+"-"+f+", #object-nav li.current").addClass("selected");jq(".item-list-tabs li.selected").addClass("loading");jq('.item-list-tabs select option[value="'+d+'"]').prop("selected",!0);if("friends"===
c||"group_members"===c)c="members";bp_ajax_request&&bp_ajax_request.abort();bp_ajax_request=jq.post(ajaxurl,{action:c+"_filter",cookie:bp_get_cookies(),object:c,filter:d,search_terms:b,scope:f,page:e,extras:g,template:k},function(b){if("pag-bottom"===n&&jq("#subnav").length){var c=jq("#subnav").parent();jq("html,body").animate({scrollTop:c.offset().top},"slow",function(){jq(a).fadeOut(100,function(){jq(this).html(b);jq(this).fadeIn(100)})})}else jq(a).fadeOut(100,function(){jq(this).html(b);jq(this).fadeIn(100)});
jq(".item-list-tabs li.selected").removeClass("loading")})}
function bp_activity_request(c,d){jq.cookie("bp-activity-scope",c,{path:"/"});jq.cookie("bp-activity-filter",d,{path:"/"});jq.cookie("bp-activity-oldestpage",1,{path:"/"});jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected active loading")});jq("#activity-"+c+", .item-list-tabs li.current").addClass("selected");jq("#object-nav.item-list-tabs li.selected, div.activity-type-tabs li.selected").addClass("loading");jq('#activity-filter-select select option[value="'+d+'"]').prop("selected",
!0);jq(".widget_bp_activity_widget h2 span.ajax-loader").show();bp_ajax_request&&bp_ajax_request.abort();bp_ajax_request=jq.post(ajaxurl,{action:"activity_widget_filter",cookie:bp_get_cookies(),_wpnonce_activity_filter:jq("#_wpnonce_activity_filter").val(),scope:c,filter:d},function(c){jq(".widget_bp_activity_widget h2 span.ajax-loader").hide();jq("div.activity").fadeOut(100,function(){jq(this).html(c.contents);jq(this).fadeIn(100);bp_legacy_theme_hide_comments()});null!=c.feed_url&&jq(".directory #subnav li.feed a, .home-page #subnav li.feed a").attr("href",
c.feed_url);jq(".item-list-tabs li.selected").removeClass("loading")},"json")}
function bp_legacy_theme_hide_comments(){var c=jq("div.activity-comments"),d,f,a;c.addClass("clearboth").find("form").css("display","none");c.find("ul").addClass("list-unstyled");if(!c.length)return!1;c.each(function(){5>jq(this).children("ul").children("li").length||(comments_div=jq(this),d=comments_div.parents("#activity-stream > li"),f=jq(this).children("ul").children("li"),a=" ",jq("#"+d.attr("id")+" a.acomment-reply span").length&&(a=jq("#"+d.attr("id")+" a.acomment-reply span").html()),f.each(function(b){b<
f.length-5&&(jq(this).addClass("hidden"),jq(this).toggle(),b||jq(this).before('<li class="show-all"><a href="#'+d.attr("id")+'/show-all/" title="'+BP_DTheme.show_all_comments+'">'+BP_DTheme.show_x_comments.replace("%d",a)+"</a></li>"))}))})}function checkAll(){var c=document.getElementsByTagName("input"),d;for(d=0;d<c.length;d++)"checkbox"===c[d].type&&(""===$("check_all").checked?c[d].checked="":c[d].checked="checked")}
function clear(c){if(c=document.getElementById(c)){var d=c.getElementsByTagName("INPUT");c=c.getElementsByTagName("OPTION");var f=0;if(d)for(f=0;f<d.length;f++)d[f].checked="";if(c)for(f=0;f<c.length;f++)c[f].selected=!1}}function bp_get_cookies(){var c=document.cookie.split(";"),d={},f,a,b,e;for(f=0;f<c.length;f++)a=c[f],b=a.indexOf("="),e=jq.trim(unescape(a.slice(0,b))),a=unescape(a.slice(b+1)),0===e.indexOf("bp-")&&(d[e]=a);return encodeURIComponent(jq.param(d))};